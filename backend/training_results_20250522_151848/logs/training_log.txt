[2025-05-22 15:18:48] ===== BẮT ĐẦU HUẤN LUYỆN MÔ HÌNH DỰ ĐOÁN ĐIỂM SỐ SINH VIÊN =====
[2025-05-22 15:18:48] Đang đọc tập dữ liệu...
[2025-05-22 15:18:48] Đọc dữ liệu thành công: 535 dòng và 33 cột
[2025-05-22 15:18:48] 
=== PHÂN TÍCH DỮ LIỆU ===
[2025-05-22 15:18:48] Kích thước dữ liệu: (535, 33)
[2025-05-22 15:18:48] Các cột trong dữ liệu: student_code, school, sex, age, address, famsize, Pstatus, Medu, Fedu, Mjob, Fjob, guardian, traveltime, studytime, failures, schoolsup, famsup, paid, activities, nursery, higher, internet, romantic, famrel, freetime, goout, Dalc, Walc, health, absences, G1, G2, G3
[2025-05-22 15:18:48] Không phát hiện giá trị null trong dữ liệu
[2025-05-22 15:18:48] 
Thống kê mô tả:
[2025-05-22 15:18:48] 
              count         mean          std    min  ...     75%     max  missing  dtype
student_code  535.0  4541.319626  2876.558174  117.0  ...  7159.0  9997.0        0  int64
age           535.0    16.893458     1.224689   15.0  ...    18.0    22.0        0  int64
Medu          535.0     2.719626     1.098129    0.0  ...     4.0     4.0        0  int64
Fedu          535.0     2.506542     1.073800    0.0  ...     3.0     4.0        0  int64
traveltime    535.0     1.469159     0.691361    1.0  ...     2.0     4.0        0  int64
studytime     535.0     2.132710     0.945696    1.0  ...     3.0     4.0        0  int64
failures      535.0     0.416822     0.821126    0.0  ...     1.0     3.0        0  int64
famrel        535.0     3.889720     0.954482    1.0  ...     5.0     5.0        0  int64
freetime      535.0     3.226168     1.064963    1.0  ...     4.0     5.0        0  int64
goout         535.0     3.048598     1.212247    1.0  ...     4.0     5.0        0  int64
Dalc          535.0     1.570093     0.978344    1.0  ...     2.0     5.0        0  int64
Walc          535.0     2.327103     1.300934    1.0  ...     3.0     5.0        0  int64
health        535.0     3.450467     1.371484    1.0  ...     5.0     5.0        0  int64
absences      535.0     5.259813     7.206542    0.0  ...     8.0    75.0        0  int64
G1            535.0    11.084112     3.478994    3.0  ...    14.0    19.0        0  int64
G2            535.0    11.018692     3.977891    0.0  ...    14.0    19.0        0  int64
G3            535.0    10.960748     4.805618    0.0  ...    15.0    20.0        0  int64

[17 rows x 10 columns]
[2025-05-22 15:18:48] 
Phân tích biến mục tiêu G3:
[2025-05-22 15:18:48] Giá trị trung bình: 10.96
[2025-05-22 15:18:48] Độ lệch chuẩn: 4.81
[2025-05-22 15:18:48] Giá trị nhỏ nhất: 0
[2025-05-22 15:18:48] Giá trị lớn nhất: 20
[2025-05-22 15:18:48] Phân phối tứ phân vị: [9.0, 11.0, 15.0]
[2025-05-22 15:18:49] 
Đang phân tích tương quan giữa các biến...
[2025-05-22 15:18:49] 
Tương quan với G3:
G3              1.000000
G2              0.932634
G1              0.854384
Medu            0.402450
studytime       0.384362
Fedu            0.320308
famrel          0.311785
student_code   -0.001469
absences       -0.136997
age            -0.194488
traveltime     -0.199613
freetime       -0.272329
Walc           -0.297183
Dalc           -0.302326
health         -0.306731
goout          -0.410490
failures       -0.494618
Name: G3, dtype: float64
[2025-05-22 15:18:50] 
Đang phân tích các biến phân loại...
[2025-05-22 15:18:50] 
Điểm trung bình G3 theo school:
school
MS    12.188034
GP    10.617225
Name: G3, dtype: float64
[2025-05-22 15:18:50] 
Điểm trung bình G3 theo sex:
sex
M    11.610895
F    10.359712
Name: G3, dtype: float64
[2025-05-22 15:18:51] 
Điểm trung bình G3 theo address:
address
R    11.326389
U    10.826087
Name: G3, dtype: float64
[2025-05-22 15:18:51] 
Điểm trung bình G3 theo famsize:
famsize
GT3    11.071429
LE3    10.725146
Name: G3, dtype: float64
[2025-05-22 15:18:51] 
Điểm trung bình G3 theo Pstatus:
Pstatus
A    12.121951
T    10.750552
Name: G3, dtype: float64
[2025-05-22 15:18:51] 
Điểm trung bình G3 theo Mjob:
Mjob
health      14.528302
teacher     12.612500
services    11.920290
other        9.314286
at_home      9.101124
Name: G3, dtype: float64
[2025-05-22 15:18:52] 
Điểm trung bình G3 theo Fjob:
Fjob
teacher     14.720000
health      12.958333
services    11.126437
other       10.391304
at_home      7.411765
Name: G3, dtype: float64
[2025-05-22 15:18:52] 
Điểm trung bình G3 theo guardian:
guardian
father    12.241135
mother    10.914040
other      7.311111
Name: G3, dtype: float64
[2025-05-22 15:18:52] 
Điểm trung bình G3 theo schoolsup:
schoolsup
yes    12.833333
no     10.582022
Name: G3, dtype: float64
[2025-05-22 15:18:52] 
Điểm trung bình G3 theo famsup:
famsup
yes    11.604167
no      9.874372
Name: G3, dtype: float64
[2025-05-22 15:18:52] 
Điểm trung bình G3 theo paid:
paid
yes    11.298578
no     10.740741
Name: G3, dtype: float64
[2025-05-22 15:18:53] 
Điểm trung bình G3 theo activities:
activities
yes    12.085714
no      9.725490
Name: G3, dtype: float64
[2025-05-22 15:18:53] 
Điểm trung bình G3 theo nursery:
nursery
yes    11.490741
no      8.737864
Name: G3, dtype: float64
[2025-05-22 15:18:53] 
Điểm trung bình G3 theo higher:
higher
yes    11.128655
no      7.045455
Name: G3, dtype: float64
[2025-05-22 15:18:53] 
Điểm trung bình G3 theo internet:
internet
yes    11.625000
no      7.884211
Name: G3, dtype: float64
[2025-05-22 15:18:53] 
Điểm trung bình G3 theo romantic:
romantic
no     11.591304
yes     9.815789
Name: G3, dtype: float64
[2025-05-22 15:18:53] 
=== TIỀN XỬ LÝ DỮ LIỆU ===
[2025-05-22 15:18:53] Đang mã hóa các biến phân loại...
[2025-05-22 15:18:53] Sau khi mã hóa: 40 biến
[2025-05-22 15:18:53] Đang chia tập dữ liệu thành tập huấn luyện và kiểm tra...
[2025-05-22 15:18:53] Tập huấn luyện: 428 mẫu
[2025-05-22 15:18:53] Tập kiểm tra: 107 mẫu
[2025-05-22 15:18:53] Đang chuẩn hóa dữ liệu...
[2025-05-22 15:18:53] Đã chuẩn hóa dữ liệu xong
[2025-05-22 15:18:53] 
=== LỰA CHỌN ĐẶC TRƯNG ===
[2025-05-22 15:18:53] Đang xác định các đặc trưng quan trọng...
[2025-05-22 15:18:54] 
Top 10 đặc trưng quan trọng nhất:
         feature  importance
15            G2    0.862660
13      absences    0.053437
0   student_code    0.010093
1            age    0.009999
14            G1    0.005458
3           Fedu    0.005225
11          Walc    0.005033
12        health    0.004993
7         famrel    0.004987
10          Dalc    0.004456
[2025-05-22 15:18:54] 
Số đặc trưng được chọn: 2
[2025-05-22 15:18:54] Các đặc trưng được chọn: absences, G2
[2025-05-22 15:18:54] 
=== HUẤN LUYỆN MÔ HÌNH ===
[2025-05-22 15:18:54] Đang đánh giá sơ bộ các mô hình...
[2025-05-22 15:18:54] Hồi quy tuyến tính: RMSE CV = 1.7417 (±0.2909)
[2025-05-22 15:18:54] Ridge: RMSE CV = 1.7331 (±0.2903)
[2025-05-22 15:18:54] Lasso: RMSE CV = 1.6700 (±0.3618)
[2025-05-22 15:18:54] Cây quyết định: RMSE CV = 1.6575 (±0.4886)
[2025-05-22 15:18:55] Random Forest: RMSE CV = 1.4461 (±0.2514)
[2025-05-22 15:18:55] Gradient Boosting: RMSE CV = 1.5206 (±0.2687)
[2025-05-22 15:18:57] XGBoost: RMSE CV = 1.3674 (±0.2791)
[2025-05-22 15:18:58] 
Đang tối ưu hóa siêu tham số cho mô hình Cây quyết định...
[2025-05-22 15:19:04] Siêu tham số tốt nhất cho Cây quyết định: {'criterion': 'squared_error', 'max_depth': 5, 'max_features': None, 'min_samples_leaf': 8, 'min_samples_split': 2}
[2025-05-22 15:19:04] RMSE tốt nhất từ CV: 1.5433
[2025-05-22 15:19:04] 
Đang tối ưu hóa siêu tham số cho mô hình Random Forest...
[2025-05-22 15:19:20] Siêu tham số tốt nhất cho Random Forest: {'max_depth': 10, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 200}
[2025-05-22 15:19:20] RMSE tốt nhất từ CV: 1.4536
[2025-05-22 15:19:20] 
Đang tối ưu hóa siêu tham số cho mô hình XGBoost...
[2025-05-22 15:19:58] Siêu tham số tốt nhất cho XGBoost: {'colsample_bytree': 1.0, 'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 200, 'subsample': 1.0}
[2025-05-22 15:19:58] RMSE tốt nhất từ CV: 1.2146
[2025-05-22 15:19:58] 
=== ĐÁNH GIÁ MÔ HÌNH CUỐI CÙNG ===
[2025-05-22 15:19:58] 
Kết quả đánh giá Cây quyết định (tối ưu):
[2025-05-22 15:19:58] MSE: 2.9545
[2025-05-22 15:19:58] RMSE: 1.7189
[2025-05-22 15:19:58] MAE: 1.0078
[2025-05-22 15:19:58] R²: 0.8759
[2025-05-22 15:19:59] 
Kết quả đánh giá Random Forest (tối ưu):
[2025-05-22 15:19:59] MSE: 2.7534
[2025-05-22 15:19:59] RMSE: 1.6593
[2025-05-22 15:19:59] MAE: 0.9485
[2025-05-22 15:19:59] R²: 0.8843
[2025-05-22 15:20:00] 
Kết quả đánh giá XGBoost (tối ưu):
[2025-05-22 15:20:00] MSE: 3.3720
[2025-05-22 15:20:00] RMSE: 1.8363
[2025-05-22 15:20:00] MAE: 0.9701
[2025-05-22 15:20:00] R²: 0.8583
[2025-05-22 15:20:01] 
Mô hình tốt nhất là: Random Forest (tối ưu)
[2025-05-22 15:20:01] RMSE: 1.6593
[2025-05-22 15:20:01] R²: 0.8843
[2025-05-22 15:20:01] 
Đang lưu các mô hình...
[2025-05-22 15:20:01] Đã lưu Cây quyết định (tối ưu) tại training_results_20250522_151848\models\Cây_quyết_định_tối_ưu.pkl
[2025-05-22 15:20:01] Đã lưu Random Forest (tối ưu) tại training_results_20250522_151848\models\Random_Forest_tối_ưu.pkl
[2025-05-22 15:20:01] Đã lưu XGBoost (tối ưu) tại training_results_20250522_151848\models\XGBoost_tối_ưu.pkl
[2025-05-22 15:20:01] Đã lưu mô hình tốt nhất tại models/decision_tree_model.pkl
[2025-05-22 15:20:01] 
=== THÔNG TIN THÊM VỀ DỮ LIỆU VÀ MÔ HÌNH ===
[2025-05-22 15:20:01] Đặc trưng quan trọng nhất là: G2
[2025-05-22 15:20:01] 
=== TÓM TẮT QUÁ TRÌNH ===
[2025-05-22 15:20:01] Số lượng mẫu: 535
[2025-05-22 15:20:01] Số lượng đặc trưng ban đầu: 33
[2025-05-22 15:20:01] Số lượng đặc trưng sau khi mã hóa: 39
[2025-05-22 15:20:01] Số lượng đặc trưng được chọn: 2
[2025-05-22 15:20:01] Mô hình tốt nhất: Random Forest (tối ưu)
[2025-05-22 15:20:01] RMSE của mô hình tốt nhất: 1.6593
[2025-05-22 15:20:01] R² của mô hình tốt nhất: 0.8843
[2025-05-22 15:20:01] Đã lưu mô hình tại: models/decision_tree_model.pkl
[2025-05-22 15:20:01] 
===== HOÀN THÀNH QUÁ TRÌNH HUẤN LUYỆN =====
